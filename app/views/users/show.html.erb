<div class="container d-flex flex-column align-items-center">
    <div class="row mt-5">
      <% if user_signed_in? && @user == current_user %>
     　 <h1 class="font-weight-normal">マイページ</h1>
      <% else %>
      　<h1 class="font-weight-normal"><%= @user.name %>さんのページ</h1>
      <% end %>
    </div>
    <% if user_signed_in? && @user == current_user %>
      <p class="d-flex align-self-end">
        <%= link_to "プロフィール編集", edit_user_path(@user), class: "btn btn-success" %>
      </p>
    <% end %>
    <% if current_user != @user %>
      <% if current_user.following?(@user) %>
        <p class="d-flex align-self-end">
          <%= link_to 'フォロー外す', user_relationships_path(@user.id),  data: { turbo_method: :delete }, class: "btn btn-danger" %>
        </p>
        <% else %>
        <p class="d-flex align-self-end">
          <%= link_to 'フォローする', user_relationships_path(@user.id),  data: { turbo_method: :post }, class:"btn btn-success" %>
        </p>
      <% end %>
    <% end %>
    <div class="d-flex w-100">
      <% if @user.profile_image.attached? %>
        <%= image_tag @user.profile_image, size: '100x100', class: "mb-3 profile-img profile-img--round" %>
      <% end %>
      <h4 class="ml-3 mb-3 card w-100 profile"><%= @user.profile %></h4>
    </div>
    <div class="d-flex">
      <%= link_to follows_user_path(@user) do %>
        <h6>フォロー<%= @following_users.count %></h6>
      <% end %>  
      <%= link_to followers_user_path(@user) do %>
        <h6>フォロワー<%= @follower_users.count %></h6>
      <% end %>
    </div>

    <% if user_signed_in? && @user == current_user %>
      <div class="row mt-5 w-100">
        <h5 class="mb-3">体重記録</h5>
        <%= form_with model: [@user, @weight_record], url: user_weights_path(@user), local: true, class: "form-inline mb-4" do |f| %>
          <%= f.date_field :date, class: "form-control mr-2" %>
          <%= f.number_field :value, step: 0.1, placeholder: "体重(kg)", class: "form-control mr-2", style: "width: 120px;" %>
          <%= f.submit "記録する", class: "btn btn-success" %>
        <% end %>
        <%= render "weights/calendar", user: @user, calendar_date: @calendar_date, weights_by_date: @weights_by_date %>
      </div>
      <h5 class="mt-5 mb-3">自分の投稿一覧（記録）</h5>
    <% end %>

    <div class="row mt-3 index-left w-100">
      <% @posts.each do |post| %>
        <div class="one-post col-sm-3 mb-3">
          <%= link_to post_path(post) do %>
           <% if post.image.attached? %>
              <%= image_tag post.image.variant(resize_to_limit: [200, 133]) %>
            <% end %>
           <p class="caption mb-0"><%= post.location %></p>
           <p class="caption"><%= "#{post.comments.count} コメント" %></p>
          <% end %>
        </div>
      <% end %>
    </div>
    <%= paginate @posts %>
  </div>